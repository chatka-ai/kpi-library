id: cash_conversion_cycle
display_name: Cash Conversion Cycle (days)
domain: Finance
category: Working Capital
aliases: ["CCC"]
description: DSO + DIO âˆ’ DPO.
grain: month
dimensions:
  - { name: month, semantic: temporal }
  - { name: bu, semantic: business_unit }
derived_from: []
business_rules: {}
formula:
  expression: "AVG(dso_days) + AVG(dio_days) - AVG(dpo_days)"
  notes: "Derived from AR/AP/Inventory metrics; confirm data latency."
sql:
  bigquery:
    source_table: your_project.finance.facts_pnl
    metric_view: your_project.analytics_mv.ccc_monthly
    params: ["@start_date", "@end_date"]
    query: |
      SELECT
        DATE_TRUNC(date, MONTH) AS month,
        bu,
        AVG(dso_days) + AVG(dio_days) - AVG(dpo_days) AS cash_conversion_cycle
      FROM `your_project.finance.facts_pnl`
      WHERE date BETWEEN @start_date AND @end_date
      GROUP BY 1,2
tests:
  - name: range
    assertion: "cash_conversion_cycle BETWEEN -100 AND 300"
examples:
  business_questions:
    - "CCC trend by BU?"
    - "Which lever improved CCC last quarter?"
demo:
  seed_data: seeds/finance/finance_facts.sample.csv

